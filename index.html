<!DOCTYPE html>
<html>
<head>
  <title>Web Bluetooth Serial Monitor</title>
</head>
<body>
  <button onclick="connectToDevice()">Connect</button>
  <button onclick="disconnectFromDevice()">Disconnect</button>
  <button onclick="sendMessage()">Send Message</button>

  <input type="text" id="messageInput" placeholder="Enter message">

  <pre id="log"></pre>

  <script>
    let device;
let logElement;

async function connectToDevice() {
  try {
    logElement = document.getElementById('log');
    log('Requesting Bluetooth Device...');
    device = await navigator.bluetooth.requestDevice({
      filters: [{ name: 'mpy-uart' }],
      optionalServices: ['6e400001-b5a3-f393-e0a9-e50e24dcca9e']
    });

    log('Connecting to GATT Server...');
    const server = await device.gatt.connect();

    // More code for getting services and characteristics...
  } catch (error) {
    log('Error: ' + error);
  }
}
    async function sendMessage() {
  try {
    const messageInput = document.getElementById('messageInput');
    const message = messageInput.value;
    const encoder = new TextEncoder('utf-8');
    const data = encoder.encode(message);
    await writeCharacteristic.writeValue(data);
    log('Sent: ' + message);
    messageInput.value = '';
  } catch (error) {
    log('Error: ' + error);
  }
}

    readCharacteristic.addEventListener('characteristicvaluechanged', handleData);

function handleData(event) {
  const value = event.target.value;
  const decoder = new TextDecoder('utf-8');
  const data = decoder.decode(value);
  log('Received: ' + data);
}
  </script>
</body>
</html>
