<!DOCTYPE html>
<html>
  <head>
    <title>ESP32 BLE</title>
  </head>
  <body>
    <button id="connect">Connect to ESP32</button>
    <div id="value">Value: </div>

    <script>
      document.getElementById('connect').addEventListener('click', function() {
        navigator.bluetooth.requestDevice({
          filters: [{
            services: ['4fafc201-1fb5-459e-8fcc-c5c9c331914b']
          }]
        })
        .then(device => device.gatt.connect())
        .then(server => server.getPrimaryService('4fafc201-1fb5-459e-8fcc-c5c9c331914b'))
        .then(service => service.getCharacteristic('beb5483e-36e1-4688-b7f5-ea07361b26a8'))
        .then(characteristic => characteristic.startNotifications())
        .then(characteristic => {
          characteristic.addEventListener('characteristicvaluechanged', function(event) {
            var value = new Float32Array(event.target.value.buffer);
            document.getElementById('value').textContent = 'Value: ' + value[0];
          });
        })
        .catch(error => console.log(error));
      });
    </script>
  </body>
</html>
